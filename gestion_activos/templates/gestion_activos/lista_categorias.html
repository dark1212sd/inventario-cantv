{% extends 'gestion_activos/base.html' %}
{% load static %}

{% block title %}Lista de Categor√≠as{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2 class="text-primary fw-bold">Categor√≠as</h2>

  <div class="d-flex align-items-center gap-2">
    <div id="buscador-wrapper" class="position-relative">
      <i id="icono-buscar" class="fas fa-search fs-4 text-dark" style="cursor:pointer;"></i>
      <input type="text" id="input-busqueda" class="form-control form-control-sm animate__animated"
             style="width: 0; opacity: 0; position: absolute; top: -5px; left: 30px; transition: all 0.3s;"
             placeholder="Buscar categor√≠a">
    </div>

    <a href="{% url 'crear_categoria' %}" class="btn btn-success btn-sm">
      <i class="fas fa-folder-plus"></i> Agregar Categor√≠a
    </a>
  </div>
</div>

<table id="tabla-categorias" class="table table-striped table-bordered">
  <thead class="table-secondary">
    <tr>
      <th>Nombre</th>
      <th>Acciones</th>
    </tr>
  </thead>
  <tbody>
    {% for cat in categorias %}
    <tr>
      <td>{{ cat.nombre }}</td>
      <td>
        <a href="{% url 'editar_categoria' cat.pk %}" class="btn btn-sm btn-warning">‚úèÔ∏è</a>
        <a href="{% url 'eliminar_categoria' cat.pk %}" class="btn btn-sm btn-danger">üóëÔ∏è</a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}

{% block extra_js %}
<script>
  $(function () {
    const tabla = $('#tabla-categorias').DataTable({
      language: { url: '//cdn.datatables.net/plug-ins/1.13.4/i18n/es-ES.json' }
    });

    const input = document.getElementById('input-busqueda');
    $('#icono-buscar').on('click', function () {
      if (input.style.width === "0px" || input.style.width === "") {
        input.style.width = "200px";
        input.style.opacity = "1";
        input.focus();
      } else {
        input.style.width = "0";
        input.style.opacity = "0";
      }
    });

    input.addEventListener('keyup', function () {
      tabla.search(this.value).draw();
    });
  });
</script>
{% endblock %}