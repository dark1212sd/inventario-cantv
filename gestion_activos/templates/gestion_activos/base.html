{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>{% block title %}Inventario CANTV{% endblock %}</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,300,400,600,700,800,900" rel="stylesheet">

    <link href="{% static 'css/sb-admin-2.min.css' %}" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.bootstrap5.min.css">

    <style>
      .sidebar {
        z-index: 1045; /* Asegura que esté por encima del backdrop */
      }
      .sidebar-backdrop {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1044; /* Justo detrás del sidebar */
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s, visibility 0.3s;
      }
      .sidebar-backdrop.show {
        opacity: 1;
        visibility: visible;
      }
    </style>
    {% block extra_head %}{% endblock %}
</head>
<body id="page-top">

    <div id="wrapper">

        <ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion toggled" id="accordionSidebar">

            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="{% url 'index' %}">
                <div class="sidebar-brand-icon">
                    <img src="https://res.cloudinary.com/dqnmq5tdg/image/upload/v1750315151/logo_menu_xsf9gl.png" alt="Logo" style="height: 40px;">
                </div>
                <div class="sidebar-brand-text mx-3">Inventario</div>
            </a>
            <hr class="sidebar-divider my-0">

            <li class="nav-item"><a class="nav-link" href="{% url 'lista_activos' %}"><i class="fas fa-fw fa-boxes-stacked"></i><span>Activos</span></a></li>
            <li class="nav-item"><a class="nav-link" href="{% url 'lista_categorias' %}"><i class="fas fa-fw fa-layer-group"></i><span>Categorías</span></a></li>
            <li class="nav-item"><a class="nav-link" href="{% url 'lista_ubicaciones' %}"><i class="fas fa-fw fa-location-dot"></i><span>Ubicaciones</span></a></li>
            <li class="nav-item"><a class="nav-link" href="{% url 'lista_usuarios' %}"><i class="fas fa-fw fa-users"></i><span>Usuarios y Roles</span></a></li>
            <li class="nav-item"><a class="nav-link" href="{% url 'vista_bitacora' %}"><i class="fas fa-fw fa-history"></i><span>Bitácora</span></a></li>

            <hr class="sidebar-divider d-none d-md-block">
            <li class="nav-item"><a class="nav-link" href="{% url 'logout' %}"><i class="fas fa-fw fa-sign-out-alt"></i><span>Cerrar sesión</span></a></li>
        </ul>

        <div class="sidebar-backdrop" id="sidebarBackdrop"></div>

        <div id="content-wrapper" class="d-flex flex-column">
            <div id="content">
                <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">
                    <button id="sidebarToggleTop" class="btn btn-link rounded-circle mr-3">
                        <i class="fa fa-bars"></i>
                    </button>
                    <h1 class="h4 mb-0 text-gray-800">{% block page_title %}Dashboard{% endblock %}</h1>
                    <ul class="navbar-nav ms-auto">
                        </ul>
                </nav>

                <div class="container-fluid">
                    {% block content %}{% endblock %}
                </div>
            </div>
            <footer class="sticky-footer bg-white">
                <div class="container my-auto">
                    <div class="copyright text-center my-auto">
                        <span>Copyright &copy; Tu Proyecto 2025</span>
                    </div>
                </div>
            </footer>
        </div>
    </div>

    <div id="django-messages" style="display: none;">
      {% if messages %}{% for message in messages %}
        <div class="django-message" data-tag="{{ message.tags }}" data-message="{{ message }}"></div>
      {% endfor %}{% endif %}
    </div>

    <script src="{% static 'vendor/jquery/jquery.min.js' %}"></script>
    <script src="{% static 'vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'vendor/jquery-easing/jquery.easing.min.js' %}"></script>

    <script src="{% static 'js/sb-admin-2.min.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // --- LÓGICA PARA EL NUEVO SIDEBAR OVERLAY ---
        const sidebar = document.getElementById('accordionSidebar');
        const toggleBtn = document.getElementById('sidebarToggleTop');
        const backdrop = document.getElementById('sidebarBackdrop');

        function toggleSidebar() {
            sidebar.classList.toggle('toggled');
            backdrop.classList.toggle('show');
        }

        if (toggleBtn) { toggleBtn.addEventListener('click', toggleSidebar); }
        if (backdrop) { backdrop.addEventListener('click', toggleSidebar); }


        // --- Lógica para las notificaciones SweetAlert2 ---
        const messages = document.querySelectorAll('.django-message');
        if (messages.length > 0) {
            const messageEl = messages[0];
            // ... (resto del script de SweetAlert2 que ya teníamos)
        }
    });
    </script>

    {% block extra_js %}{% endblock %}
</body>
</html>